
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-8.2.6">
    
    
      
        <title>Building plugins - Xournal++</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.9d5733d3.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/buttons.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="deep-orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#building-plugins" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Xournal++" class="md-header__button md-logo" aria-label="Xournal++" data-md-component="logo">
      
  <img src="../../../img/favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Xournal++
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Building plugins
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/xournalpp/xournalpp/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    xournalpp/xournalpp
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../installation/" class="md-tabs__link">
        Installation
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../overview/" class="md-tabs__link md-tabs__link--active">
        Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../community/help/" class="md-tabs__link">
        Community
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://github.com/xournalpp/xournalpp/issues" class="md-tabs__link">
      Report a bug
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Xournal++" class="md-nav__button md-logo" aria-label="Xournal++" data-md-component="logo">
      
  <img src="../../../img/favicon.ico" alt="logo">

    </a>
    Xournal++
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/xournalpp/xournalpp/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    xournalpp/xournalpp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Installation" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        OS selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/windows/" class="md-nav__link">
        Windows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/macos/" class="md-nav__link">
        MacOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../whirlwind-tour/" class="md-nav__link">
        Whirlwind Tour
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/preferences/" class="md-nav__link">
        Preferences
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/toolbar-colors/" class="md-nav__link">
        Toolbar Colors
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4">
          Tools and Editing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tools and Editing" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Tools and Editing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/pen/" class="md-nav__link">
        Pen and Highlighter tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/eraser/" class="md-nav__link">
        Eraser tool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/selecsnap/" class="md-nav__link">
        Selection and Snapping tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/latex/" class="md-nav__link">
        LaTeX tool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/pdf_tools/" class="md-nav__link">
        PDF tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/geometry/" class="md-nav__link">
        Geometry tools
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pdfs/" class="md-nav__link">
        Working With PDF Files
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_6" type="checkbox" id="__nav_3_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_6">
          Plugins
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Plugins" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          Plugins
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Building plugins
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Building plugins
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#plugin-manager" class="md-nav__link">
    Plugin manager
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-folder" class="md-nav__link">
    Installation folder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plugin-structure" class="md-nav__link">
    Plugin structure
  </a>
  
    <nav class="md-nav" aria-label="Plugin structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pluginini" class="md-nav__link">
    plugin.ini
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mainlua" class="md-nav__link">
    main.lua
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plugin-api" class="md-nav__link">
    Plugin API
  </a>
  
    <nav class="md-nav" aria-label="Plugin API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    Error-handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-plugins-to-define-shortcuts-for-ui-actions" class="md-nav__link">
    Using plugins to define shortcuts for ui actions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrieving-information-about-the-document-and-iterating-through-pages-and-layers" class="md-nav__link">
    Retrieving information about the document and iterating through pages and layers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-lua-modules" class="md-nav__link">
    Using Lua modules
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notable/" class="md-nav__link">
        Notable plugins
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../file-locations/" class="md-nav__link">
        File Locations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/" class="md-nav__link">
        Tips
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Community
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Community" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Community
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/help/" class="md-nav__link">
        Getting help & helping out
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/other-software/" class="md-nav__link">
        Xournal++ & other software
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/xournalpp/xournalpp/issues" class="md-nav__link">
        Report a bug
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/xournalpp/xournalpp.github.io/edit/site/docs/guide/plugins/plugins.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="building-plugins">Building Plugins<a class="headerlink" href="#building-plugins" title="Permanent link">&para;</a></h1>
<p>Xournal++ provides a basic Lua Plugin interface. Plugins can be added without building Xournal++ from source. Their primary use is to add user-specific functionality, shortcuts, make calls to external programs, define user-specific export functions and the like.</p>
<p>In general the Lua Plugin interface is still in an early stage and will be expanded over time.</p>
<p>In order to use Lua Plugins make sure you have <code>Lua (version &gt;=5.3)</code> installed on your device.</p>
<h2 id="plugin-manager">Plugin manager<a class="headerlink" href="#plugin-manager" title="Permanent link">&para;</a></h2>
<p>Plugins must be activated or deactivated in the Plugin manager (from menu <code>Plugin &gt; Plugin manager</code>). The Plugin manager lists the installation folder, description, author and version for each plugin. Only activated plugins will be listed in the menubar and only those can be run. The other plugins are safely excluded. Note that a restart of Xournal++ is required to change the activation of a plugin.</p>
<h2 id="installation-folder">Installation folder<a class="headerlink" href="#installation-folder" title="Permanent link">&para;</a></h2>
<p>Plugins shipped with Xournal++ reside in the same folder, the <code>plugins</code> subfolder of the
<a href="../../file-locations/">shared recources folder</a>.</p>
<p>In the latest development version, custom plugins can be stored in the <code>plugins</code> subfolder
of the <a href="../../file-locations/">config folder</a>. Create the <code>plugins</code> subfolder manually, if
it does not exist.</p>
<p>Each plugin has its files stored in a subfolder of the plugin folder and contains
at least a <code>plugin.ini</code> file and a Lua code file.</p>
<h2 id="plugin-structure">Plugin structure<a class="headerlink" href="#plugin-structure" title="Permanent link">&para;</a></h2>
<p>The <code>plugin.ini</code> file contains the name of the author, the version number, info on whether it is enabled by default
or not and a reference to the main Lua code file. A sample file (referencing <code>main.lua</code>) is:</p>
<h4 id="pluginini"><strong><code>plugin.ini</code></strong><a class="headerlink" href="#pluginini" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">[about]</span>
<span class="c1">## Author / Copyright notice</span>
<span class="na">author</span><span class="o">=</span><span class="s">NAME OF THE AUTHOR</span>

<span class="na">description</span><span class="o">=</span><span class="s">DESCRIPTION OF THE PLUGIN</span>

<span class="c1">## If the plugin is packed with Xournal++, use</span>
<span class="c1">## &lt;xournalpp&gt; then it gets the same version number</span>
<span class="na">version</span><span class="o">=</span><span class="s">&lt;xournalpp&gt;</span>

<span class="k">[default]</span>
<span class="na">enabled</span><span class="o">=</span><span class="s">false</span>

<span class="k">[plugin]</span>
<span class="na">mainfile</span><span class="o">=</span><span class="s">main.lua</span>
</code></pre></div>
<p>The Lua code file referenced in the <code>plugin.ini</code> file must define an <code>initUi</code>-function that registers toolbar actions and initializes all UI stuff. It is supposed to call the <code>app.registerUi</code>-function, whose argument is a Lua table containing</p>
<ul>
<li>the <code>menu</code> name displayed in Xournal++'s menubar,</li>
<li>the <code>callback</code> function used when the plugin is called from the menu or via a keyboard accelerator,</li>
<li>the <code>accelerator</code> used to execute the plugin callback function. The format looks like <code>&lt;Control&gt;a</code> or <code>&lt;Shift&gt;&lt;Alt&gt;F1</code>, see <a href="https://docs.gtk.org/gtk4/func.accelerator_parse.html">GTK4 reference</a> for details. The accelerator can be omitted. Using accelerators without modifiers like (<code>&lt;Alt&gt;</code>, <code>&lt;Control&gt;</code>, <code>&lt;Shift&gt;</code>) is allowed, but will likely break the text tool.</li>
</ul>
<p>You can register multiple menu entires/accelators in the same plugin by using <code>app.registerUi</code> multiple times.</p>
<p>A sample file for the main Lua code file is:</p>
<h4 id="mainlua"><strong><code>main.lua</code></strong><a class="headerlink" href="#mainlua" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- Register all Toolbar actions and intialize all UI stuff</span>
<span class="kr">function</span> <span class="nf">initUi</span><span class="p">()</span>
  <span class="n">app</span><span class="p">.</span><span class="n">registerUi</span><span class="p">({[</span><span class="s2">&quot;menu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NAME&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;callback&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;accelerator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;Alt&gt;F1&quot;</span><span class="p">});</span>
<span class="c1">-- ADD MORE CODE, IF NEEDED</span>
<span class="kr">end</span>

<span class="c1">-- Callback if the menu item is executed</span>
<span class="kr">function</span> <span class="nf">run</span><span class="p">()</span>
<span class="c1">-- ADD CODE LIKE</span>
<span class="c1">-- app.uiAction({[&quot;action&quot;]=&quot;ACTION_TOOL_PEN&quot;})</span>
<span class="c1">-- TO SWITCH TO THE PEN TOOL, OR</span>
<span class="c1">-- app.changeToolColor({[&quot;color&quot;] = 0xff0000, [&quot;selection&quot;] = true})</span>
<span class="c1">-- TO CHANGE THE COLOR OF THE CURRENT TOOL TO RED</span>
<span class="kr">end</span>
</code></pre></div>
<p>For more extensive examples of plugins, you can check out the code of the plugins bundled with Xournal++ <a href="https://github.com/xournalpp/xournalpp/tree/master/plugins">in the repository</a>.</p>
<h2 id="plugin-api">Plugin API<a class="headerlink" href="#plugin-api" title="Permanent link">&para;</a></h2>
<h3 id="error-handling">Error-handling<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h3>
<p>Functions of the xounalpp Lua-Api will return Lua errors which can be handled by
calling the function with
<a href="https://www.lua.org/manual/5.4/manual.html#pdf-pcall"><code>pcall</code></a> when something
<em>unexpected happens</em> (like wrong arguments passed). In rare cases
<code>nil, errorMessage</code> might be returned to silently throwing an error. This is
reserved for <em>expected things</em> (like the resource is unavailable). You may make
such errors to Lua errors by wrapping with <a href="https://www.lua.org/manual/5.4/manual.html#pdf-assert"><code>assert</code></a>.</p>
<h3 id="functions">Functions<a class="headerlink" href="#functions" title="Permanent link">&para;</a></h3>
<p>Any Lua Plugin can execute a number of Xournal++ functions to interact with Xournal++.Those are defined in the Plugin API as seen in the
<a href="https://github.com/xournalpp/xournalpp/blob/master/plugins/luapi_application.def.lua">definition file</a>. That file shows the list of all Xournal++ functions, its function parameters, return values and example usage. Moreover it can be used with the <a href="https://luals.github.io/">Lua language server</a> to get code completion, hover tooltips, jump-to-definition, find-references, and more. For writing plugins using
one of the many <a href="https://microsoft.github.io/language-server-protocol/implementors/tools/">code editors</a> that support the Lua language server is advisable. If you need
more information how these Xournal++ functions are defined, see the
<code>luapi_application.h</code> file which is relevant to your version of xournalpp:</p>
<ul>
<li><a href="https://github.com/xournalpp/xournalpp/blob/release-1.1/src/plugin/luapi_application.h">1.1.x series</a></li>
<li><a href="https://github.com/xournalpp/xournalpp/blob/release-1.2/src/core/plugin/luapi_application.h">1.2.x series</a></li>
<li><a href="https://github.com/xournalpp/xournalpp/blob/master/src/core/plugin/luapi_application.h">nightly builds</a></li>
</ul>
<h3 id="using-plugins-to-define-shortcuts-for-ui-actions">Using plugins to define shortcuts for ui actions<a class="headerlink" href="#using-plugins-to-define-shortcuts-for-ui-actions" title="Permanent link">&para;</a></h3>
<p>Currently Xournal++ does not have shortcuts/keybindings configurable in the preferences. However you can write your custom plugin to achieve exactly that.</p>
<p>The function <code>app.uiAction</code> used for simulating a toolbar/menubar click can be used for lots of different actions.
This command accepts a Lua table with keys
<code>"action"</code> and <code>"enabled"</code> as its argument. The <code>"enabled"</code> key is set to <code>true</code> by default, so you can often omit it. The <code>"action"</code> key accepts
one of the action strings listed in the source file <a href="https://github.com/xournalpp/xournalpp/blob/master/src/core/plugin/ActionBackwardCompatibilityLayer.cpp">ActionBackwardCompatibilityLayer.cpp</a>. Note that the list of actions will change when new functionality is added to Xournal++.</p>
<p>For example use:</p>
<div class="highlight"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">uiAction</span><span class="p">({</span> <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;ACTION_RULER&quot;</span> <span class="p">})</span>
</code></pre></div>
<p>to activate the ruler (for drawing line segments) or</p>
<div class="highlight"><pre><span></span><code><span class="n">app</span><span class="p">.</span><span class="n">uiAction</span><span class="p">({</span> <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;ACTION_TOOL_FILL&quot;</span><span class="p">,</span> <span class="n">enabled</span> <span class="o">=</span> <span class="kc">false</span> <span class="p">})</span>
</code></pre></div>
<p>to turn off filling of shapes.</p>
<h3 id="retrieving-information-about-the-document-and-iterating-through-pages-and-layers">Retrieving information about the document and iterating through pages and layers<a class="headerlink" href="#retrieving-information-about-the-document-and-iterating-through-pages-and-layers" title="Permanent link">&para;</a></h3>
<p>The <code>app.getDocumentStructure</code> function yields a Lua table of the following shape:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="n">pages</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">{</span>
      <span class="n">pageWidth</span> <span class="o">=</span> <span class="n">number</span><span class="p">,</span>
      <span class="n">pageHeight</span> <span class="o">=</span> <span class="n">number</span><span class="p">,</span>
      <span class="n">isAnnoated</span> <span class="o">=</span> <span class="n">bool</span><span class="p">,</span>
      <span class="n">pageTypeFormat</span> <span class="o">=</span> <span class="n">string</span><span class="p">,</span>
      <span class="n">pdfBackgroundPageNo</span> <span class="o">=</span> <span class="n">integer</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kr">if</span> <span class="n">there</span> <span class="n">is</span> <span class="n">no</span> <span class="n">pdf</span> <span class="n">background</span> <span class="n">page</span><span class="p">),</span>
      <span class="n">layers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
          <span class="n">isVisible</span> <span class="o">=</span> <span class="n">bool</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
          <span class="n">isVisible</span> <span class="o">=</span> <span class="n">bool</span><span class="p">,</span>
          <span class="n">isAnnotated</span> <span class="o">=</span> <span class="n">bool</span>
        <span class="p">},</span>
        <span class="p">...</span>
      <span class="p">},</span>
      <span class="n">currentLayer</span> <span class="o">=</span> <span class="n">integer</span>
    <span class="p">},</span>
  <span class="p">...</span>
  <span class="p">}</span>
  <span class="n">currentPage</span> <span class="o">=</span> <span class="n">integer</span><span class="p">,</span>
  <span class="n">pdfBackgroundFilename</span> <span class="o">=</span> <span class="n">string</span> <span class="p">(</span><span class="n">empty</span> <span class="kr">if</span> <span class="n">there</span> <span class="n">is</span> <span class="n">none</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>So for example to get the number of all pages, the page number of the current page and the layer ID of the current layer use the code:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">docStructure</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="n">getDocumentStructure</span><span class="p">()</span>
<span class="kd">local</span> <span class="n">numPages</span> <span class="o">=</span> <span class="o">#</span><span class="n">docStructure</span><span class="p">.</span><span class="n">pages</span>
<span class="kd">local</span> <span class="n">currPage</span> <span class="o">=</span> <span class="n">docStructure</span><span class="p">.</span><span class="n">currentPage</span>
<span class="kd">local</span> <span class="n">currLayer</span> <span class="o">=</span> <span class="n">docStructure</span><span class="p">.</span><span class="n">pages</span><span class="p">[</span><span class="n">currPage</span><span class="p">].</span><span class="n">currentLayer</span>
</code></pre></div>
<p>You can iterate through all pages by using the lines</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">docStructure</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="n">getDocumentStructure</span><span class="p">()</span>
<span class="kd">local</span> <span class="n">numPages</span> <span class="o">=</span> <span class="o">#</span><span class="n">docStructure</span><span class="p">.</span><span class="n">pages</span>
<span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numPages</span> <span class="kr">do</span>
  <span class="c1">-- ADD CODE TO EXECUTE FOR PAGE i</span>
<span class="kr">end</span>
</code></pre></div>
<p>Similarly you can run through all layers of a page. In case of the current page this would read like</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">docStructure</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="n">getDocumentStructure</span><span class="p">()</span>
<span class="kd">local</span> <span class="n">page</span> <span class="o">=</span> <span class="n">docStructure</span><span class="p">.</span><span class="n">currentPage</span>
<span class="kd">local</span> <span class="n">numLayers</span> <span class="o">=</span> <span class="o">#</span><span class="n">docStructure</span><span class="p">.</span><span class="n">pages</span><span class="p">[</span><span class="n">page</span><span class="p">].</span><span class="n">layers</span>
<span class="kr">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numLayers</span> <span class="kr">do</span>
  <span class="c1">-- ADD CODE TO EXECUTE FOR LAYER i</span>
<span class="kr">end</span>
</code></pre></div>
<h2 id="using-lua-modules">Using Lua modules<a class="headerlink" href="#using-lua-modules" title="Permanent link">&para;</a></h2>
<p>More complex Plugins will require Lua modules for certain operations. For instance if your Plugin needs
a more sophisticated GUI or wants to repeat tasks in predefined time intervals, you may want to use the
<code>lgi</code>-module via <code>require("lgi")</code>.</p>
<p>The Lua package path by default contains the root folder of the plugin and the system Lua package path.
In case you need other folders in the package path, use the package.path key to add them.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../pdfs/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Working With PDF Files" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Working With PDF Files
            </div>
          </div>
        </a>
      
      
        
        <a href="../notable/" class="md-footer__link md-footer__link--next" aria-label="Next: Notable plugins" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Notable plugins
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"latest_stable": "1.2.7", "latest_unstable": "1.2.7+dev"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e87a5f81.min.js"></script>
      
    
  </body>
</html>